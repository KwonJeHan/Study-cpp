# 언리얼 C++ 학습 정리

**2025/04/01 [포텐업] 게임 개발자 양성 과정**

---

## 언리얼 오브젝트

* 클래스 기본 객체(CDO) : 클래스의 기본 값과 타입 정보의 제공

* 리플렉션(Reflection) : 런타임에서 클래스 정보의 참조 기능

* 인터페이스(Interface) : 모던 객체 지향 언어가 제공하는 인터페이스의 제공

* 향상된 열거형 : 보다 향상된 열거형의 지원
* 델리게이트(Deligate) : 객체간의 결합을 낮출 수 있는 델리게이트 기능의 제공
* 가비지컬렉션(Garbage Collection) : 자동 메모리 관리
* 향상된 구조체(Struct) : 리플렉션이 가능한 구조체의 지원
* 직렬화(Serialization) : 객체 정보를 바이트 스트림으로 저장, 전송, 불러들이는 기능



게임이 대형화되면서 성능과 유지보수 두 가지가 모두 중요해졌다.

언리얼 엔진은 C++ 언어를 확장한 언리얼 오브젝트라는 객체 구조를 고안했다.

지정된 매크로를 사용해 빌드를 수행하면, 추가 코드가 자동으로 만들어지는 구조를 가진다.

언리얼 오브젝트를 사용해 대규모 게임 제작을 안정적으로 설계하고 구현할 수 있다.



## 언리얼 오브젝트 시스템

1. 언리얼 오브젝트에는 항상 클래스 정보를 담은 UClass 객체가 매칭되어 있다.

2. UClass로부터 언리얼 오브젝트의 정보를 파악할 수 있음.

3. UClass에는 클래스 기본 오브젝트(CDO)가 연결되어 있어 이를 활용해 개발의 생산성을 향상시킬 수 있음.

4. 클래스 정보와 CDO는 엔진 초기화 과정에서 생성되므로 게임 개발에서 안전하게 사용 가능.

5. 헤더 정보를 변경하거나 생성자 정보를 변경하면 에디터를 끄고 컴파일하는 것이 안정적임.



### 언리얼 리플렉션

C++은 어떠한 형태의 리플렉션도 지원하지 않는데 언리얼에선 자체적으로 시스템을 구축해 UPROPERTY(), UFUNCTION(), UENUM() 등의 매크로를 통해 언리얼 리플렉션 시스템(프로퍼티 시스템)사용할 수 있다.

1. 리플렉션 시스템을 사용해 언리얼 오브젝트의 특정 속성과 함수를 이름으로 검색할 수 있다.

2. 리플렉션 시스템을 사용해 접근 지시자와 무관하게 값을 설정할 수 있다.

3. 리플렉션 시스템을 사용해 언리얼 오브젝트의 함수를 호출할 수 있다.

해당 매크로를 사용하기 위해선 generated.h 선언이 필요하다.

헤더 파일에 include 시 generated.h 보다 위에 선언해야 한다.

cpp 파일에 include 시 본인의 .h 헤더 파일이 가장 위에 와야 한다.



## 언리얼 C++ 인터페이스

**인터페이스**

* 객체가 **반드시** 구현해야 할 행동을 지정하는데 활용되는 **타입**
* 다형성의 구현, 의존성이 분리된 설계에 유용하게 활용된다.



인터페이스를 생성하면 두 개의 클래스가 생성된다.

* U로 시작하는 타입의 클래스 : 런타입에서 인터페이스 구현 여부를 파악하는 용도로 실제로 U타입 클래스에서 작업하게 될 일은 없다.
* I로 시작하는 타입의 클래스 : 객체를 설계할 때는 해당 클래스를 사용하며 인터페이스에 관련된 구성 및 구현은 해당 클래스에서 진행한다.



**추상 타입으로만 선언할 수 있는 Java, C#과 달리 언리얼은 인터페이스에서도 구현이 가능하다.**



## 언리얼 C++ 컴포지션

객체 지향 설계에선 상속이 가진 Is-A 관계만 의존해서는 설계와 유지 보수가 힘들다. 

**컴포지션은 객체 지향 설계에서 Has-A 관계를 구현하는 설계 방법**으로 게임의 복잡한 객체를 효과적으로 설계하는데 유용하게 사용할 수 있다.



예를 들어 Person과 그 구성원 Student, Teacher, Staff가 있다고 가정해보자.

현재 Person의 구성원을 보았을 때 모두 School Card가 필요해보여 Person내에 Card를 구현했다.

하지만 이후 Person에서 Card가 필요하지 않은 객체도 Person을 상속받게 되면 Card 또한 받는다.

이렇게 Is-A관계에서 Has-A 관계로 바꿔줘 객체 지향에 어울리게 하는 방법이 **Composition**이다.



#### Composition 구현 방법

하나의 언리얼 오브젝트는 항상 CDO를 가지고 있으며 언리얼 오브젝트에 다른 언리얼 오브젝트를 조합할 때 2가지 선택지가 존재한다.

1. CDO에 미리 언리얼 오브젝트를 생성해 조합 (언제나 필수적으로 포함) - 생성자에서부터 추가가 되며 C++에서 CreateDefalutSubobject()로 만들어준다.
2. CDO에 빈 포인터만 넣고 런타임에 언리얼 오브젝트를 생성해 조합 (필요할 때 선택적 포함) - 게임 런타임동안 작동하는 코드에 NewObject()를 통해 생성한다.

CreateDefalutSubobject() 와 NewObject() 를 통해 내가 소유한 Object를 Subobject라고 하며 나를 소유한 언리얼 오브젝트는 Outer라고 한다.
