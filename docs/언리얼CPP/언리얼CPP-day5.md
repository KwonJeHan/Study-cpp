# 언리얼 C++ 학습 정리

**2025/04/07 [포텐업] 게임 개발자 양성 과정**

---

## 언리얼 오브젝트 관리 - 직렬화

(콘텐츠 제작 시에는 많이 고려하지 않는 요소지만 시스템 구축 시에는 중요도 높음)

**오브젝트나 연결된 오브젝트의 묶음(오브젝트 그래프)을 바이트 스트림으로 변환하는 과정**

* 복잡한 데이터를 일렬로 세우기 때문에 **직렬화**

거꾸로 복구시키는 과정도 포함해서 의미

* 시리얼라이제이션 : 오브젝트 그래프에서 바이트 스트림으로
* 디시리얼라이제이션 : 바이트 스트림에서 오브젝트 그래프로

장점

* 현재 프로그램의 상태를 저장하고 필요할 때 복원 가능(게임의 저장)
* 현재 객체의 정보를 클립보드에 복사해서 다른 프로그램에 전송 가능
* 네트워크를 통해 현재 프로그램의 상태를 다른 컴퓨터에 복원 가능(멀티플레이어 게임)
* 데이터 압축, 암호화를 통해 데이터를 효율적이고 안전하게 보관할 수도 있음



#### 직렬화 구현 시 고려할 점

데이터 레이아웃 : 오브젝트가 소유한 다양한 데이터를 변환할 것인가?

이식성 : 서로 다른 시스템에 전송해도 이식될 수 있는가?

버전 관리 : 새로운 기능이 추가될 때 이를 어떻게 확장하고 처리할 것인가?

성능 : 네트웍 비용을 줄이기 위해 어떤 데이터 형식을 사용할 것인가?

보안 : 데이터를 어떻게 안전하게 보호할 것인가?

에러 처리 : 전송 과정에서 문제가 발생할 경우 이를 어떻게 인식하고 처리할 것인가?



언리얼 엔진은 이러한 상황을 모두 고려한 짖렬화 시스템을 자체적으로 제공한다.

* 직렬화 시스템을 위해 제공하는 클래스 FArchive와 연산자
  * 아카이브 클래스 (FArchive)
  * Shift(<<) operator
* 다양한 아카이브 클래스 제공
  * 메모리 아카이브 (FMemoryReader, FMemoryWriter)
  * 파일 아카이브 (FArchiveFileReaderGeneric, FArchiveFileWriterGeneric)
  * 기타 언리얼 오브젝트와 관련된 아카이브 클래스 (FArchiveUObject)
* Json 직렬화 기능 : 별도의 라이브러리를 통해 제공



## 언리얼 오브젝트 관리 - 패키지

패키지의 중의적 개념

1. **언리얼 오브젝트를 감싼 포장 오브젝트를 의미**
2. 개발된 최종 콘텐츠를 정리해 프로그램으로 만드는 작업을 의미 (게임 패키징)
3. DLC와 같이 향후 확장 콘텐츠에 사용되는 별도의 데이터 묶음을 의미 (pkg 파일)

여기서 설명할 패키지는 1번의 의미를 가지고 있다. 구분을 위해 언리얼 오브젝트 패키지라고 부른다.



**언리얼 오브젝트 패키지는 다수의 언리얼 오브젝트를 포장하는데 사용하는 언리얼 오브젝트이다.**

언리얼 오브젝스의 서브 오브젝트를 에셋(Asset)이라고 하며 에디터에는 이들이 노출된다.

구조상 패키지는 다수의 언리얼 오브젝트를 소유할 수 있으나, 일반저긍로 하나의 에셋만 가진다.

에셋은 다시 다수의 서브 오브젝트를 가질 수 있으며, 모두 언리얼 오브젝트 패키지에 포함된다. (하지만 에디터에는 노출되지 않음)



#### 에셋 정보의 저장과 로딩 전략

게임 제작 단계에서 에셋 간의 연결 작업을 위해 직접 패키지를 불러 할당하는 작업은 부하가 크다.

* 에셋 로딩 대신 패키지와 오브젝트를 지정한 문자열을 대체해서 사용한다. 이를 **오브젝트 경로**라고 한다.
* 프로젝트 내에서 오브젝트 경로 값은 유일함을 보장한다. 그렇기에 오브젝트 간의 연결은 오브젝트 경로 값으로 기록될 수 있다.
* 오브젝트 경로를 사용해 다양한 방법으로 에셋을 로딩할 수 있다.

**에셋 로딩 전략**

* 프로젝트에서 에셋이 반드시 필요한 경우 : 생성자 코드에서 미리 로딩
* 런타임에서 필요한 때 바로 로딩하는 경우 : 런타임 로직에서 정적 로딩
* 런타임에서 비동기적으로 로딩하는 경우 : 런타임 로직에서 관리자를 사용해 비동기 로딩



#### 오브젝트 경로

**패키지 이름과 에셋 이름을 한 데 묶은 문자열**

에셋 클래스 정보는 생략 가능하며 패키지 내 데이터를 모두 로드하지 않고 오브젝트 경로를 사용해 필요한 에셋만 로드할 수 있다.

**{애셋클래스정보}'{패키지이름}.{애셋이름}'**

**or**

**{패키지이름}.{애셋이름}**



#### 에셋 스트리밍 관리자

**에셋의 비동기 로딩을 지원하는 관리자 객체**

콘텐츠 제작과 무관한 싱글턴 클래스에 FStreamableManager를 선언해두면 좋다.

* GameInstance는 좋은 선택지

FStreamableManager를 활용해 에셋의 동기/비동기 로딩을 관리할 수 있다.

다수의 오브젝트 경로를 입력해 다수의 에셋을 로딩하는 것도 가능하다.
